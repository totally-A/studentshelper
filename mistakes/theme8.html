<!DOCTYPE html>
<html>
<head>
	<title>Student's Helper: Текстові файли</title>
	<meta charset="utf-8">
	<link rel="stylesheet" href="../css/style.css">
	<link rel="stylesheet" href="../css/articles.css">
	<link rel="shortcut icon" href="../img/icons/mortarboard.ico">

	<!-- Bootsrap feauters -->
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="../bootstrap-3.3.6-dist/css/bootstrap.min.css">

	<!-- Optional theme -->
	<link rel="stylesheet" href="../bootstrap-3.3.6-dist/css/bootstrap-theme.min.css">

	<!-- Latest compiled and minified JavaScript -->
	<script src="../bootstrap-3.3.6-dist/js/bootstrap.min.js"></script>

	<!-- Font Awesome -->
	<link rel="stylesheet" href="../font-awesome-4.6.3/css/font-awesome.min.css">

	<!-- Fonts -->
	<link href='https://fonts.googleapis.com/css?family=Jura:600&subset=latin,cyrillic,cyrillic-ext' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Lobster&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
</head>
<body>
	<header>
		<div class="wrapper">
			<a href="../index.html" class="logo">
				<div class="emblem">
					
				</div>
				<div class="text">
					Student's Helper
				</div>			
			</a>
			<div class="top-nav">
				<nav>
					<ul>
						<a href="../index.html">
							<li class="general">Головна
								<div class="arrow"></div>
							</li>
						</a>
						<a href="../theory.html">
							<li class="theory">Теорія
								<div class="arrow"></div>
							</li>
						</a>
						<a href="../tests.html">
							<li class="tests">Тести
								<div class="arrow"></div>
							</li>
						</a>
					</ul>
				</nav>
			</div>
		</div>
	</header>
	<div class="main">
		<div class="wrapper">
			<div class="info">
				<h2>
					Текстові файли
				</h2>
				<p>
					 Робота з текстовим файлом схожа роботу з консоллю: за допомогою функцій форматованого введення ми зберігаємо дані в файл, за допомогою функцій форматованого виведення зчитуємо дані з файлу. Є безліч нюансів, які ми пізніше розглянемо. Основні операції, які необхідно виконати, це<br/>
1. Відкрити файл, для того, щоб до нього можна було звертатися. Відповідно, відкривати можна для читання, записи, читання і запису, переписування або записи в кінець файлу і т.п. Коли ви відкриваєте файл, може також статися купа помилок - файлу може не існувати, це може бути файл не того типу, у вас може не бути прав на роботу з файлом і т.д. Все це необхідно враховувати.<br/>
2. Безпосередньо робота з файлом - запис і читання. Тут також потрібно пам'ятати, що ми працюємо не з пам'яттю з довільним доступом, а з буферизованим потоком, що додає свою специфіку.<br/>
3. Закрити файл. Так як файл є зовнішнім по відношенню до програми ресурсом, то якщо його не закрити, то він продовжить висіти в пам'яті, можливо, навіть після закриття програми (наприклад, не можна буде видалити відкритий файл або внести зміни і т.п.). Крім того, іноді необхідно не закривати, а "перевідкривати" файл для того, щоб, наприклад, змінити режим доступу.<br/>
Крім того, існує ряд завдань, коли нам не потрібно звертатися до вмісту файлу: перейменування, переміщення, копіювання і т.д. На жаль, в стандарті сі немає опису функцій для цих потреб. Вони, безумовно, є для кожної з реалізацій компілятора. Зчитування вмісту каталогу (папки, директорії) - це теж звернення до файлу, тому що папка сама по собі є файлом з метаінформацією.<br/>
Іноді необхідно виконувати деякі допоміжні операції: переміститися в потрібне місце файлу, запам'ятати поточне положення, визначити довжину файлу і т.д.<br/>
Для роботи з файлом необхідний об'єкт FILE. Цей об'єкт зберігає ідентифікатор файлового потоку і інформацію, яка потрібна, щоб їм управляти, включаючи покажчик на його буфер, індикатор позиції в файлі і індикатори стану.
Об'єкт FILE сам по собі є структурою, але до його полях не повинно бути доступу. Переноситься програма повинна працювати з файлом як з абстрактним об'єктом, що дозволяє отримати доступ до файлового потоку.<br/>
Створення і виділення пам'яті під об'єкт типу FILE здійснюється за допомогою функції fopen або tmpfile (є й інші, але ми зупинимося тільки на цих).<br/>
Функція fopen відкриває файл. Вона отримує два аргументи - рядок з адресою файлу і рядок з режимом доступу до файлу. Файл може бути як абсолютним, так і відносним. fopen повертає покажчик на об'єкт FILE, за допомогою якого далі можна здійснювати доступ до файлу.
				</p>
				<h3>
					Типові помилки програмування
				</h3>
				<ul class="main-info">
					<li>Відкриття раніше створеного файлу для запису (“w”), тоді як насправді користувач хоче зберегти дані, які вже є у файлі. Зміст файлу видаляється без попередження.</li>
					<li>Забувають відкрити файл, перед тим, як посилатися на нього у програмі.</li>
					<li>Посилаючись на файл, використовують невірний покажчик файлу.</li>
					<li>Відкриття для читання неіснуючого файлу.</li>
					<li>Відкриття файлу для читання чи запису без відповідних привілегій доступу до файлу(це залежить від операційної системи).</li>
					<li>Відкриття файлу для запису при відсутності вільного місця на диску.</li>
					<li>Невірний вибір режиму відкриття файлу може призвести до фатальних помилок. Наприклад, якщо відкрити файл у режимі запису (“w”) замість режиму оновлення, це призведе до повної втрати вмісту файлу.</li>
				</ul>

				<div class="example">
					<h3>
					Приклад програми
				</h3>
				<p>
					Розглянемо застосування текстових файлів на прикладі.<br/>
Умова задачі: У текстовому файлі data.txt записано цілі числа, розділені довільною кількістю будь-яких пробільних символів, з можливими порожніми рядками в будь-якому місці файлу. Переписати в новий текстовий файл res.txt по одному в рядок без додаткових пробільних символів тільки ті з чисел, які кратні 2.
				</p>
				<pre>
#include < stdio.h >
#include < conio.h >
#include < iostream >

void Solution();//prototype

FILE *fs, *fp;//file pointer

//========================== main function ==========================
int main()
{
	system("color F0");
	//the existing file is open for reading
	fs = fopen("data.txt", "r");
	if (!fs)
		puts("Error of opening of a input-file" "data.txt");
	else
	{              //open a new file to record
		fp = fopen("res.txt", "w");
		if (!fp)
			puts("Error of opening of a output-file" "res.txt");
		else
		{
			Solution();
			fclose(fp);      //closing the resulting file
			puts("Copying is completed!");
		}
		fclose(fs);              //closure Input
	}
	system("pause");
}
//========================== finding the solution ==========================
void Solution()
{
	int z, flag = 0;
	while (!feof(fs))
	{
		fscanf(fs, "%d", &z);
			if (z % 2 == 0)
			{                   //all numbers except the first,
				if (flag)         //derive after transition
					putc('\n', fp);      //to the new line
				fprintf(fp, "%d", z);
				flag = 1;
			}
	}
}
				</pre>
				<p>
					Завантажте "Аналіз коду" для подробиць.
				</p>
</div>
			</div>
			<div class="buttons">
				<a href="../material/Текстові файли.doc" class="review button" download>
					Аналіз коду
				</a>
			</div>

			<a href="../mistakes.html" class="back-btn"><i class="fa fa-long-arrow-left" aria-hidden="true"></i>Назад</a>	
		</div>
	</div>
	<footer>
		<div class="wrapper">
			<div class="line-1">
				<div class="short-info">
					Student's Helper - це український волонтерський проект, розроблений для того, щоб допомогти студенту у галузі програмування.
				</div>
				<div class="bot-nav">
					<nav>
						<ul>
							<a href="../documentation.html">
								<li>Про проект</li>
							</a>
							<a href="../devs.html">
								<li>Розробники</li>
							</a>
						</ul>
					</nav>
				</div>
			</div>		
			<div class="line-2">
				© 2016 Найкраща тіма на світі. Усі права захищені.
			</div>	
		</div>
	</footer>
</body>
</html>